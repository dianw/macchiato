"use strict";!function(){angular.module("es",["angular-loading-bar","ngSanitize","restangular","textAngular","ui.bootstrap","ui.router"])}(),function(){angular.module("es").controller("ContactFormCtrl",["$state","$stateParams","RestContactService",function(t,a,e){function r(){e.one(a.id).get().then(function(t){t.phone=Number(t.phone),o.contact=t})}function n(a){a.id?a.put().then(function(){t.go("contact-list")}):e.post(a).then(function(){t.go("contact-list")})}var o=this;o.contact={},o.load=r,o.save=n,"+"!==a.id&&r()}])}(),function(){angular.module("es").controller("ContactListCtrl",["$location","RestContactService",function(t,a){function e(){o.searchParams.hash++,o.searchParams.page=o.currentPage-1,delete o.searchParams.offset,t.search(o.searchParams),o.searchParams.offset=o.searchParams.max*o.searchParams.page,a.getList(o.searchParams).then(function(t){o.contacts=t,t.forEach(r)})}function r(t){t.one("groups").getList().then(function(a){t.groups=a})}function n(t){var a=window.confirm("Delete contacts?");a&&t.remove().then(function(){e()})}var o=this;o["delete"]=n,o.search=e,o.searchParams=t.search(),o.searchParams.hash=0,o.searchParams.page=_.defaultTo(o.searchParams.page,0),o.searchParams.max=_.defaultTo(o.searchParams.max,10),o.currentPage=_.defaultTo(o.currentPage,o.searchParams.page+1),e()}])}(),function(){angular.module("es").config(["$stateProvider",function(t){t.state("contact-list",{url:"/backend/contacts",controller:"ContactListCtrl as ctrl",templateUrl:"app/contact/contact.list.html"}).state("contact-form",{url:"/backend/contacts/:id",controller:"ContactFormCtrl as ctrl",templateUrl:"app/contact/contact.form.html"})}])}(),function(){angular.module("es").factory("RestContactService",["Restangular",function(t){return t.service("contacts")}])}(),function(){angular.module("es").controller("GroupContactListCtrl",["$location","$stateParams","RestContactService","RestGroupService",function(t,a,e,r){function n(t,a){t.post("contacts",a).then(function(){u.contact=null,s(t)},function(){u.contact=null})}function o(t){return e.getList({max:5,q:t})}function c(){return r.one(a.id).get().then(function(t){u.group=t,s(t)})}function s(a){u.searchParams.hash++,u.searchParams.page=u.currentPage-1,delete u.searchParams.offset,t.search(u.searchParams),u.searchParams.offset=u.searchParams.max*u.searchParams.page,a.getList("contacts",u.searchParams).then(function(t){a.contacts=t})}function l(t,a){var e=window.confirm("Remove "+a.name+"?");e&&t.one("contacts",a.id).remove().then(function(){s(t)})}var u=this;u.addContact=n,u.removeContact=l,u.search=s,u.searchContacts=o,u.searchParams=t.search(),u.searchParams.hash=0,u.searchParams.page=_.defaultTo(u.searchParams.page,0),u.searchParams.max=_.defaultTo(u.searchParams.max,10),u.currentPage=_.defaultTo(u.currentPage,u.searchParams.page+1),c()}])}(),function(){angular.module("es").controller("GroupFormCtrl",["$state","$stateParams","RestGroupService",function(t,a,e){function r(){e.one(a.id).get().then(function(t){o.group=t})}function n(a){a.id?a.put().then(function(){t.go("group-list")}):e.post(a).then(function(){t.go("group-list")})}var o=this;o.group={},o.load=r,o.save=n,"+"!==a.id&&r()}])}(),function(){angular.module("es").controller("GroupListCtrl",["$location","RestGroupService",function(t,a){function e(){o.searchParams.hash++,o.searchParams.page=o.currentPage-1,delete o.searchParams.offset,t.search(o.searchParams),o.searchParams.offset=o.searchParams.max*o.searchParams.page,a.getList(o.searchParams).then(function(t){o.groups=t,t.forEach(r)})}function r(t){t.getList("contacts",{max:0}).then(function(a){t.contacts=a})}function n(t){var a=window.confirm("Delete groups?");a&&t.remove().then(function(){e()})}var o=this;o["delete"]=n,o.search=e,o.searchParams=t.search(),o.searchParams.hash=0,o.searchParams.page=_.defaultTo(o.searchParams.page,0),o.searchParams.max=_.defaultTo(o.searchParams.max,10),o.currentPage=_.defaultTo(o.currentPage,o.searchParams.page+1),e()}])}(),function(){angular.module("es").config(["$stateProvider",function(t){t.state("group-list",{url:"/backend/groups",controller:"GroupListCtrl as ctrl",templateUrl:"app/group/group.list.html"}).state("group-form",{url:"/backend/groups/:id",controller:"GroupFormCtrl as ctrl",templateUrl:"app/group/group.form.html"}).state("group-contact-list",{url:"/backend/groups/:id/contacts?q",controller:"GroupContactListCtrl as ctrl",templateUrl:"app/group/group.contact.list.html"})}])}(),function(){angular.module("es").factory("RestGroupService",["Restangular",function(t){return t.service("groups")}])}(),function(){angular.module("es").controller("TemplateFormCtrl",["$state","$stateParams","RestTemplateService",function(t,a,e){function r(){e.one(a.id).get().then(function(t){o.template=t})}function n(a){a.id?a.put().then(function(){t.go("template-list")}):e.post(a).then(function(){t.go("template-list")})}var o=this;o.template={},o.load=r,o.save=n,"+"!==a.id&&r()}])}(),function(){angular.module("es").controller("TemplateListCtrl",["$location","RestTemplateService",function(t,a){function e(){o.searchParams.hash++,o.searchParams.page=o.currentPage-1,delete o.searchParams.offset,t.search(o.searchParams),o.searchParams.offset=o.searchParams.max*o.searchParams.page,a.getList(o.searchParams).then(function(t){o.templates=t,t.forEach(r)})}function r(t){t.getList("contacts",{max:0}).then(function(a){t.contacts=a})}function n(t){var a=window.confirm("Delete templates?");a&&t.remove().then(function(){e()})}var o=this;o["delete"]=n,o.search=e,o.searchParams=t.search(),o.searchParams.hash=0,o.searchParams.page=_.defaultTo(o.searchParams.page,0),o.searchParams.max=_.defaultTo(o.searchParams.max,10),o.currentPage=_.defaultTo(o.currentPage,o.searchParams.page+1),e()}])}(),function(){angular.module("es").config(["$stateProvider",function(t){t.state("template-list",{url:"/backend/templates",controller:"TemplateListCtrl as ctrl",templateUrl:"app/template/template.list.html"}).state("template-form",{url:"/backend/templates/:id",controller:"TemplateFormCtrl as ctrl",templateUrl:"app/template/template.form.html"}).state("template-contact-list",{url:"/backend/templates/:id/contacts?q",controller:"TemplateContactListCtrl as ctrl",templateUrl:"app/template/template.contact.list.html"})}])}(),function(){angular.module("es").factory("RestTemplateService",["Restangular",function(t){return t.service("templates")}])}(),function(){angular.module("es").config(["$httpProvider","RestangularProvider",function(t,a){a.setBaseUrl("/api"),a.setDefaultHttpFields({cache:!1}),a.addResponseInterceptor(function(t,a){var e;return"getList"===a&&angular.isObject(t)&&!angular.isArray(t)?(e=angular.copy(t.rows,e),delete t.rows,e.meta=t):e=t,e})}])}(),function(){function t(t,a,e){t.html5Mode(!0).hashPrefix("!"),a.otherwise("/backend/contacts"),e.strictMode(!1)}t.$inject=["$locationProvider","$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("es").config(t)}(),function(){function t(t){t.decorator("taOptions",a)}function a(t){"ngInject";return t.forceTextAngularSanitize=!0,t.toolbar=[["bold","italics","underline","strikeThrough"],["quote"],["ul","ol"],["redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight","indent","outdent"]],t}t.$inject=["$provide"],a.$inject=["$delegate"],angular.module("es").config(t)}();